# üí≥ –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –†–û–ë–û–ö–ê–°–°–´

## üéØ –í–ê–ñ–ù–û!
–≠—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç **–æ–¥–∏–Ω–∞–∫–æ–≤–æ** –¥–ª—è —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö –∏ –ò–ü.  
–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —Å —Å–∞–º–æ–∑–∞–Ω—è—Ç–æ–≥–æ –Ω–∞ –ò–ü –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ **–ø–æ–º–µ–Ω—è—Ç—å API –∫–ª—é—á–∏** - –∫–æ–¥ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –†–æ–±–æ–∫–∞—Å—Å–µ](#—à–∞–≥-1-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è-–≤-—Ä–æ–±–æ–∫–∞—Å—Å–µ)
2. [–°–æ–∑–¥–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π](#—à–∞–≥-2-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–∞–≥–∞–∑–∏–Ω–∞-–∏-–ø–æ–ª—É—á–µ–Ω–∏–µ-–∫–ª—é—á–µ–π)
3. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ZIP-–∞—Ä—Ö–∏–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π](#—à–∞–≥-3-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-zip-–∞—Ä—Ö–∏–≤–æ–≤-—Ñ—É–Ω–∫—Ü–∏–π)
4. [–°–æ–∑–¥–∞–Ω–∏–µ Cloud Functions –≤ Yandex Cloud](#—à–∞–≥-4-—Å–æ–∑–¥–∞–Ω–∏–µ-cloud-functions-–≤-yandex-cloud)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è](#—à–∞–≥-5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
6. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API Gateway](#—à–∞–≥-6-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-api-gateway)
7. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#—à–∞–≥-7-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
8. [–ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω](#—à–∞–≥-8-–∑–∞–ø—É—Å–∫-–≤-–ø—Ä–æ–¥–∞–∫—à–Ω)
9. [–ü–µ—Ä–µ—Ö–æ–¥ —Å —Å–∞–º–æ–∑–∞–Ω—è—Ç–æ–≥–æ –Ω–∞ –ò–ü](#—à–∞–≥-9-–ø–µ—Ä–µ—Ö–æ–¥-—Å-—Å–∞–º–æ–∑–∞–Ω—è—Ç–æ–≥–æ-–Ω–∞-–∏–ø)

---

## –®–ê–ì 1: –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –í –†–û–ë–û–ö–ê–°–°–ï

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç: **https://robokassa.com**
2. –ù–∞–∂–º–∏—Ç–µ **"–í–æ–π—Ç–∏"** ‚Üí **"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
   - –§–ò–û
   - Email
   - –¢–µ–ª–µ—Ñ–æ–Ω
   - –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email (–ø—Ä–∏–¥–µ—Ç –ø–∏—Å—å–º–æ —Å —Å—Å—ã–ª–∫–æ–π)

### 1.2 –í—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–∞

**–î–ª—è —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö:**
1. –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤—ã–±–µ—Ä–∏—Ç–µ **"–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π (–°–ú–ó)"**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - –§–ò–û (–∫–∞–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ "–ú–æ–π –Ω–∞–ª–æ–≥")
   - –ò–ù–ù —Å–∞–º–æ–∑–∞–Ω—è—Ç–æ–≥–æ
   - –ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Å–ø—Ä–∞–≤–∫—É –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è **"–ú–æ–π –Ω–∞–ª–æ–≥"**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ú–æ–π –Ω–∞–ª–æ–≥"
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ü—Ä–æ—á–µ–µ" ‚Üí "–°–ø—Ä–∞–≤–∫–∞ –æ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ —É—á–µ—Ç"
   - –°–∫–∞—á–∞–π—Ç–µ PDF —Å–ø—Ä–∞–≤–∫—É
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ø—Ä–∞–≤–∫—É –≤ –†–æ–±–æ–∫–∞—Å—Å—É

### 1.3 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –†–æ–±–æ—á–µ–∫–æ–≤ –°–ú–ó (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

1. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ **"–ú–æ–π –Ω–∞–ª–æ–≥"**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
   - –ù–∞–π–¥–∏—Ç–µ "–ü–∞—Ä—Ç–Ω—ë—Ä—ã"
   - –ù–∞–π–¥–∏—Ç–µ **"–†–æ–±–æ–∫–∞—Å—Å–∞"** –≤ —Å–ø–∏—Å–∫–µ
   - –ù–∞–∂–º–∏—Ç–µ **"–†–∞–∑—Ä–µ—à–∏—Ç—å"**
2. –≠—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —á–µ–∫–æ–≤ –≤ –§–ù–° –ø—Ä–∏ –∫–∞–∂–¥–æ–π –æ–ø–ª–∞—Ç–µ

‚è±Ô∏è **–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è

---

## –®–ê–ì 2: –°–û–ó–î–ê–ù–ò–ï –ú–ê–ì–ê–ó–ò–ù–ê –ò –ü–û–õ–£–ß–ï–ù–ò–ï –ö–õ–Æ–ß–ï–ô

### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞

–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:

1. –í–æ–π–¥–∏—Ç–µ –≤ **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã**: https://partner.robokassa.ru
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–ú–∞–≥–∞–∑–∏–Ω—ã"** ‚Üí **"–î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞:

   **–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   ```
   –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞: [–í–∞—à –º–∞–≥–∞–∑–∏–Ω]
   URL —Å–∞–π—Ç–∞: https://–≤–∞—à-—Å–∞–π—Ç.github.io
   –û–ø–∏—Å–∞–Ω–∏–µ: –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤
   ```

   **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–û–ß–ï–ù–¨ –í–ê–ñ–ù–û!):**
   ```
   Result URL (POST): https://–≤–∞—à-api-gateway.apigw.yandexcloud.net/api/payment/robokassa/callback
   Success URL: https://–≤–∞—à-—Å–∞–π—Ç.github.io/payment-success
   Fail URL: https://–≤–∞—à-—Å–∞–π—Ç.github.io/payment-failed
   
   –ú–µ—Ç–æ–¥: POST
   –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: form-data –∏–ª–∏ JSON (–æ–±–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è)
   ```

   ‚ö†Ô∏è **–í–ê–ñ–ù–û**: URL –≤–∞—à–µ–≥–æ API Gateway –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API Gateway –≤ Yandex Cloud

4. **–ê–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**: –≤—ã–±–µ—Ä–∏—Ç–µ **SHA-256** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**

### 2.2 –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π API

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"** –≤–∞—à–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ:

   ```
   –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ (Merchant Login): shop_XXXXX
   –ü–∞—Ä–æ–ª—å #1: XXXXXXXXXXXXXXXXXX
   –ü–∞—Ä–æ–ª—å #2: YYYYYYYYYYYYYYYYYY
   ```

   ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: 
   - **–ü–∞—Ä–æ–ª—å #1** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞
   - **–ü–∞—Ä–æ–ª—å #2** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –æ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã (callback)
   - **–ù–ï –ü–£–¢–ê–ô–¢–ï –ò–• –ú–ï–°–¢–ê–ú–ò!**

### 2.3 –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–¥–ª—è –Ω–∞—á–∞–ª–∞)

1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞–π–¥–∏—Ç–µ **"–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"**
2. –í–∫–ª—é—á–∏—Ç–µ –µ–≥–æ (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–µ **ON**)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## –®–ê–ì 3: –ü–û–î–ì–û–¢–û–í–ö–ê ZIP-–ê–†–•–ò–í–û–í –§–£–ù–ö–¶–ò–ô

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã –≤ –ø–∞–ø–∫–µ `yandex-functions/`. –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å ZIP-–∞—Ä—Ö–∏–≤—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Yandex Cloud.

### 3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞–ø–∫–∏:
```
yandex-functions/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ robokassa-client.js          ‚Üê –û–±—â–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îú‚îÄ‚îÄ init-payment-robokassa/
‚îÇ   ‚îú‚îÄ‚îÄ index.js
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ robokassa-callback/
‚îÇ   ‚îú‚îÄ‚îÄ index.js
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ check-payment-status/
    ‚îú‚îÄ‚îÄ index.js
    ‚îî‚îÄ‚îÄ package.json
```

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ ZIP-–∞—Ä—Ö–∏–≤–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:

**–î–ª—è Windows (PowerShell):**
```powershell
cd yandex-functions

# –§—É–Ω–∫—Ü–∏—è 1: init-payment-robokassa
Compress-Archive -Path init-payment-robokassa\*, lib -DestinationPath init-payment-robokassa.zip -Force

# –§—É–Ω–∫—Ü–∏—è 2: robokassa-callback
Compress-Archive -Path robokassa-callback\*, lib -DestinationPath robokassa-callback.zip -Force

# –§—É–Ω–∫—Ü–∏—è 3: check-payment-status
Compress-Archive -Path check-payment-status\*, lib -DestinationPath check-payment-status.zip -Force
```

**–î–ª—è Mac/Linux:**
```bash
cd yandex-functions

# –§—É–Ω–∫—Ü–∏—è 1: init-payment-robokassa
zip -r init-payment-robokassa.zip init-payment-robokassa/ lib/

# –§—É–Ω–∫—Ü–∏—è 2: robokassa-callback
zip -r robokassa-callback.zip robokassa-callback/ lib/

# –§—É–Ω–∫—Ü–∏—è 3: check-payment-status
zip -r check-payment-status.zip check-payment-status/ lib/
```

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£ –≤–∞—Å –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è 3 ZIP-—Ñ–∞–π–ª–∞:
- `init-payment-robokassa.zip`
- `robokassa-callback.zip`
- `check-payment-status.zip`

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ö–∞–∂–¥—ã–π ZIP –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- –ü–∞–ø–∫—É —Å —Ñ—É–Ω–∫—Ü–∏–µ–π (`index.js` –∏ `package.json`)
- –ü–∞–ø–∫—É `lib/` —Å –æ–±—â–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `robokassa-client.js`

---

## –®–ê–ì 4: –°–û–ó–î–ê–ù–ò–ï CLOUD FUNCTIONS –í YANDEX CLOUD

### 4.1 –§—É–Ω–∫—Ü–∏—è #1: init-payment-robokassa

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Yandex Cloud Console**: https://console.cloud.yandex.ru
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à **Folder** (–∫–∞—Ç–∞–ª–æ–≥)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"Cloud Functions"**
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é"**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   ```
   –ò–º—è: init-payment-robokassa
   –û–ø–∏—Å–∞–Ω–∏–µ: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø–ª–∞—Ç—É —á–µ—Ä–µ–∑ –†–æ–±–æ–∫–∞—Å—Å—É
   ```
6. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**
7. –í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:
   - **–°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: –≤—ã–±–µ—Ä–∏—Ç–µ **Node.js 18**
   - **–ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏**: –≤—ã–±–µ—Ä–∏—Ç–µ **ZIP-–∞—Ä—Ö–∏–≤**
   - **–§–∞–π–ª**: –∑–∞–≥—Ä—É–∑–∏—Ç–µ `init-payment-robokassa.zip`
   - **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞**: `index.handler`
   - **–¢–∞–π–º–∞—É—Ç**: `10 —Å–µ–∫—É–Ω–¥`
   - **–ü–∞–º—è—Ç—å**: `128 –ú–ë`
8. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Å–∏—é"**
9. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Ä—Å–∏–∏
10. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ñ—É–Ω–∫—Ü–∏–∏** (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è API Gateway)
    - –ù–∞–π–¥–∏—Ç–µ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞: `d4e...abc`
    - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ—ë

### 4.2 –§—É–Ω–∫—Ü–∏—è #2: robokassa-callback

–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ –∂–µ —à–∞–≥–∏, —á—Ç–æ –∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ #1:

1. **"–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é"**
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
   ```
   –ò–º—è: robokassa-callback
   –û–ø–∏—Å–∞–Ω–∏–µ: –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã –æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ–ø–ª–∞—Ç—ã
   ```
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ `robokassa-callback.zip`
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **–°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: Node.js 18
   - **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞**: `index.handler`
   - **–¢–∞–π–º–∞—É—Ç**: `10 —Å–µ–∫—É–Ω–¥`
   - **–ü–∞–º—è—Ç—å**: `128 –ú–ë`
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ñ—É–Ω–∫—Ü–∏–∏**

### 4.3 –§—É–Ω–∫—Ü–∏—è #3: check-payment-status

–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ –∂–µ —à–∞–≥–∏:

1. **"–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é"**
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
   ```
   –ò–º—è: check-payment-status
   –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
   ```
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ `check-payment-status.zip`
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **–°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: Node.js 18
   - **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞**: `index.handler`
   - **–¢–∞–π–º–∞—É—Ç**: `10 —Å–µ–∫—É–Ω–¥`
   - **–ü–∞–º—è—Ç—å**: `128 –ú–ë`
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ñ—É–Ω–∫—Ü–∏–∏**

‚úÖ **–ò—Ç–æ–≥–æ**: –£ –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 3 —Ñ—É–Ω–∫—Ü–∏–∏ –∏ 3 ID

---

## –®–ê–ì 5: –ù–ê–°–¢–†–û–ô–ö–ê –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø

–î–ª—è –ö–ê–ñ–î–û–ô –∏–∑ —Ç—Ä—ë—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### 5.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏

–î–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`init-payment-robokassa`, `robokassa-callback`, `check-payment-status`):

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤ Cloud Functions
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–†–µ–¥–∞–∫—Ç–æ—Ä"**
3. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Å–∏—é"**
4. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ **"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã"**
5. –ù–∞–π–¥–∏—Ç–µ **"–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"**
6. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–∞–∂–∏–º–∞—è **"–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é"**):

### 5.2 –°–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –†–æ–±–æ–∫–∞—Å—Å—ã:**
```bash
ROBOKASSA_MERCHANT_LOGIN=shop_XXXXX                    # –í–∞—à Merchant Login
ROBOKASSA_PASSWORD_1=–í–ê–®–ï_–ó–ù–ê–ß–ï–ù–ò–ï_–ü–ê–†–û–õ–Ø_1           # –ü–∞—Ä–æ–ª—å #1 –∏–∑ –õ–ö
ROBOKASSA_PASSWORD_2=–í–ê–®–ï_–ó–ù–ê–ß–ï–ù–ò–ï_–ü–ê–†–û–õ–Ø_2           # –ü–∞—Ä–æ–ª—å #2 –∏–∑ –õ–ö
ROBOKASSA_HASH_ALGORITHM=sha256                        # –ê–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
ROBOKASSA_TEST_MODE=true                               # –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–ø–æ—Å—Ç–∞–≤—å—Ç–µ true)
```

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ YDB (—É–∂–µ –µ—Å—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö):**
```bash
YDB_ENDPOINT=–≤–∞—à_endpoint                               # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
YDB_ACCESS_KEY_ID=–≤–∞—à_access_key                       # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
YDB_SECRET_KEY=–≤–∞—à_secret_key                          # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
```

### 5.3 –ì–¥–µ –≤–∑—è—Ç—å YDB –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ?

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±—É—é —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `create-order`)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–†–µ–¥–∞–∫—Ç–æ—Ä"**
3. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ **"–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è:
   - `YDB_ENDPOINT`
   - `YDB_ACCESS_KEY_ID`
   - `YDB_SECRET_KEY`
5. –í—Å—Ç–∞–≤—å—Ç–µ –∏—Ö –≤ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã

### 5.4 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
1. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Å–∏—é"** –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Ä—Å–∏–∏ (—Å—Ç–∞—Ç—É—Å "–ê–∫—Ç–∏–≤–Ω–∞")
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö —Ñ—É–Ω–∫—Ü–∏–π

‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ 3 —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## –®–ê–ì 6: –û–ë–ù–û–í–õ–ï–ù–ò–ï API GATEWAY

### 6.1 –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

1. –í Yandex Cloud Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **IAM** ‚Üí **–°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã**
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (—Ç–æ—Ç –∂–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ **ID** (—Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ `aje...xyz`)

### 6.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ API Gateway

–í–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å 3 –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞ –≤ –≤–∞—à API Gateway.

1. –û—Ç–∫—Ä–æ–π—Ç–µ **API Gateway** –≤ Yandex Cloud Console
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API Gateway
3. –ù–∞–∂–º–∏—Ç–µ **"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"**
4. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ —Å–µ–∫—Ü–∏—é `paths:`:

```yaml
paths:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã ...

  # ======= –†–û–ë–û–ö–ê–°–°–ê –ú–ê–†–®–†–£–¢–´ =======
  
  /api/payment/robokassa/init:
    post:
      summary: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ –†–æ–±–æ–∫–∞—Å—Å—É
      operationId: initPaymentRobokassa
      x-yc-apigateway-integration:
        type: cloud_functions
        function_id: <ID_–§–£–ù–ö–¶–ò–ò_init-payment-robokassa>
        service_account_id: <ID_–í–ê–®–ï–ì–û_–°–ï–†–í–ò–°–ù–û–ì–û_–ê–ö–ö–ê–£–ù–¢–ê>
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object

  /api/payment/robokassa/callback:
    post:
      summary: Callback –æ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã (Result URL)
      operationId: robokassaCallback
      x-yc-apigateway-integration:
        type: cloud_functions
        function_id: <ID_–§–£–ù–ö–¶–ò–ò_robokassa-callback>
        service_account_id: <ID_–í–ê–®–ï–ì–û_–°–ï–†–í–ò–°–ù–û–ì–û_–ê–ö–ö–ê–£–ù–¢–ê>
      responses:
        '200':
          description: Successful response
          content:
            text/plain:
              schema:
                type: string

  /api/payment/robokassa/check:
    get:
      summary: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
      operationId: checkPaymentStatus
      parameters:
        - name: orderId
          in: query
          required: true
          schema:
            type: string
      x-yc-apigateway-integration:
        type: cloud_functions
        function_id: <ID_–§–£–ù–ö–¶–ò–ò_check-payment-status>
        service_account_id: <ID_–í–ê–®–ï–ì–û_–°–ï–†–í–ò–°–ù–û–ì–û_–ê–ö–ö–ê–£–ù–¢–ê>
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
```

### 6.3 –ó–∞–º–µ–Ω–∞ ID —Ñ—É–Ω–∫—Ü–∏–π

–ó–∞–º–µ–Ω–∏—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID:
- `<ID_–§–£–ù–ö–¶–ò–ò_init-payment-robokassa>` ‚Üí ID —Ñ—É–Ω–∫—Ü–∏–∏ init-payment-robokassa
- `<ID_–§–£–ù–ö–¶–ò–ò_robokassa-callback>` ‚Üí ID —Ñ—É–Ω–∫—Ü–∏–∏ robokassa-callback
- `<ID_–§–£–ù–ö–¶–ò–ò_check-payment-status>` ‚Üí ID —Ñ—É–Ω–∫—Ü–∏–∏ check-payment-status
- `<ID_–í–ê–®–ï–ì–û_–°–ï–†–í–ò–°–ù–û–ì–û_–ê–ö–ö–ê–£–ù–¢–ê>` ‚Üí ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

### 6.4 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API Gateway (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-2 –º–∏–Ω—É—Ç—ã)
3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–ª—É–∂–µ–±–Ω—ã–π –¥–æ–º–µ–Ω** API Gateway:
   - –§–æ—Ä–º–∞—Ç: `https://xxxxxxxx.apigw.yandexcloud.net`
   - –≠—Ç–æ –≤–∞—à –±–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤

### 6.5 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Result URL –≤ –†–æ–±–æ–∫–∞—Å—Å–µ

1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã**
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
3. –í –ø–æ–ª–µ **Result URL** —É–∫–∞–∂–∏—Ç–µ:
   ```
   https://–≤–∞—à-–¥–æ–º–µ–Ω.apigw.yandexcloud.net/api/payment/robokassa/callback
   ```
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞**: API Gateway –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ "–ê–∫—Ç–∏–≤–µ–Ω"

---

## –®–ê–ì 7: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### 7.1 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–∞

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ curl (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)**
```bash
curl -X POST https://–≤–∞—à-api-gateway.apigw.yandexcloud.net/api/payment/robokassa/init \
  -H "Content-Type: application/json" \
  -d '{
    "orderId": "test123",
    "amount": 100,
    "email": "test@example.com",
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂"
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "paymentUrl": "https://auth.robokassa.ru/Merchant/Index.aspx?...",
  "orderId": "test123",
  "amount": 100,
  "isTest": true
}
```

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)**
```javascript
fetch('https://–≤–∞—à-api-gateway.apigw.yandexcloud.net/api/payment/robokassa/init', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    orderId: 'test123',
    amount: 100,
    email: 'test@example.com',
    description: '–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂'
  })
})
.then(r => r.json())
.then(data => console.log(data));
```

### 7.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `paymentUrl` –∏–∑ –æ—Ç–≤–µ—Ç–∞
2. –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –†–æ–±–æ–∫–∞—Å—Å—ã
4. –í —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É:
   ```
   –ù–æ–º–µ—Ä: 5555 5555 5555 5599
   –°—Ä–æ–∫: 12/25
   CVV: 123
   ```

### 7.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ callback

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –†–æ–±–æ–∫–∞—Å—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∞—à Result URL.

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `robokassa-callback`:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤ Cloud Functions
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–õ–æ–≥–∏"**
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   ‚úÖ Signature verified successfully
   ‚úÖ Order test123 marked as PAID
   ```

### 7.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞

```bash
curl "https://–≤–∞—à-api-gateway.apigw.yandexcloud.net/api/payment/robokassa/check?orderId=test123"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "orderId": "test123",
  "paymentStatus": "paid",
  "orderStatus": "processing",
  "isPaid": true,
  "paidAt": "2025-01-15T10:30:00Z"
}
```

---

## –®–ê–ì 8: –ó–ê–ü–£–°–ö –í –ü–†–û–î–ê–ö–®–ù

### 8.1 –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

1. **–í –†–æ–±–æ–∫–∞—Å—Å–µ:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
   - –û—Ç–∫–ª—é—á–∏—Ç–µ **"–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"** (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ OFF)
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

2. **–í Yandex Cloud Functions:**
   - –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ —Ç—Ä—ë—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –ò–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
     ```bash
     ROBOKASSA_TEST_MODE=false
     ```
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–æ–µ–≤–æ–º —Ä–µ–∂–∏–º–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π (100 —Ä—É–±–ª–µ–π)
2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π –ø–ª–∞—Ç—ë–∂
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ callback –ø—Ä–∏—à–µ–ª –∏ –∑–∞–∫–∞–∑ –æ–±–Ω–æ–≤–∏–ª—Å—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —á–µ–∫ –æ—Ç–ø—Ä–∞–≤–∏–ª—Å—è –≤ –§–ù–° (—á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ú–æ–π –Ω–∞–ª–æ–≥")

‚úÖ **–ì–æ—Ç–æ–≤–æ!** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –†–æ–±–æ–∫–∞—Å—Å—ã –∑–∞–ø—É—â–µ–Ω–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

---

## –®–ê–ì 9: –ü–ï–†–ï–•–û–î –° –°–ê–ú–û–ó–ê–ù–Ø–¢–û–ì–û –ù–ê –ò–ü

–ö–æ–≥–¥–∞ –≤—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç–µ—Å—å –∫–∞–∫ –ò–ü:

### 9.1 –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –†–æ–±–æ–∫–∞—Å—Å–µ

1. –í–æ–π–¥–∏—Ç–µ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –†–æ–±–æ–∫–∞—Å—Å—ã
2. –°–æ–∑–¥–∞–π—Ç–µ **–Ω–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω** (–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π!)
3. –£–∫–∞–∂–∏—Ç–µ —Å—Ç–∞—Ç—É—Å **"–ò–ü"**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ò–ü:
   - –û–ì–†–ù–ò–ü
   - –ò–ù–ù –ò–ü
   - –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç
5. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏:
   - –ù–æ–≤—ã–π Merchant Login
   - –ù–æ–≤—ã–π –ü–∞—Ä–æ–ª—å #1
   - –ù–æ–≤—ã–π –ü–∞—Ä–æ–ª—å #2

### 9.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ —Ç—Ä—ë—Ö —Ñ—É–Ω–∫—Ü–∏–π –†–æ–±–æ–∫–∞—Å—Å—ã:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤ Cloud Functions
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"–†–µ–¥–∞–∫—Ç–æ—Ä"** ‚Üí **"–°–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Å–∏—é"**
3. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   ROBOKASSA_MERCHANT_LOGIN=–Ω–æ–≤—ã–π_–ª–æ–≥–∏–Ω_–∏–ø
   ROBOKASSA_PASSWORD_1=–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å_1_–∏–ø
   ROBOKASSA_PASSWORD_2=–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å_2_–∏–ø
   ```
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é

### 9.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Result URL –≤ –Ω–æ–≤–æ–º –º–∞–≥–∞–∑–∏–Ω–µ

1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (–¥–ª—è –ò–ü)
2. –£–∫–∞–∂–∏—Ç–µ —Ç–æ—Ç –∂–µ Result URL:
   ```
   https://–≤–∞—à-–¥–æ–º–µ–Ω.apigw.yandexcloud.net/api/payment/robokassa/callback
   ```

‚úÖ **–ì–æ—Ç–æ–≤–æ!** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ò–ü –∑–∞–≤–µ—Ä—à—ë–Ω. –ö–æ–¥ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!

---

## üîß –£–°–¢–†–ê–ù–ï–ù–ò–ï –ù–ï–ü–û–õ–ê–î–û–ö

### –ü—Ä–æ–±–ª–µ–º–∞: Callback –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Result URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –†–æ–±–æ–∫–∞—Å—Å—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API Gateway –¥–æ—Å—Ç—É–ø–µ–Ω (–æ—Ç–∫—Ä–æ–π—Ç–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `robokassa-callback`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ POST

### –ü—Ä–æ–±–ª–µ–º–∞: Invalid signature

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:
   - –ü–∞—Ä–æ–ª—å #1 –¥–ª—è init-payment
   - –ü–∞—Ä–æ–ª—å #2 –¥–ª—è callback
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤ –õ–ö)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –ø–∞—Ä–æ–ª—è—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: –§—É–Ω–∫—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Cloud Functions
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ ZIP-–∞—Ä—Ö–∏–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞–ø–∫—É `lib/`

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

- **–†–æ–±–æ–∫–∞—Å—Å–∞ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞**: —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
- **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π**: https://docs.robokassa.ru/
- **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º**: –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–∞–≥–∞–∑–∏–Ω–∞

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∞–∫–∫–∞—É–Ω—Ç –≤ –†–æ–±–æ–∫–∞—Å—Å–µ
- [ ] –°–æ–∑–¥–∞–Ω –º–∞–≥–∞–∑–∏–Ω –∏ –ø–æ–ª—É—á–µ–Ω—ã API –∫–ª—é—á–∏
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –†–æ–±–æ—á–µ–∫–∏ –°–ú–ó —á–µ—Ä–µ–∑ "–ú–æ–π –Ω–∞–ª–æ–≥"
- [ ] –°–æ–∑–¥–∞–Ω—ã 3 Cloud Functions –≤ Yandex Cloud
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω API Gateway —Å –Ω–æ–≤—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏
- [ ] –£–∫–∞–∑–∞–Ω Result URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–∞–≥–∞–∑–∏–Ω–∞ –†–æ–±–æ–∫–∞—Å—Å—ã
- [ ] –ü—Ä–æ–≤–µ–¥–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- [ ] Callback –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏ –∑–∞–∫–∞–∑ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –û—Ç–∫–ª—é—á–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

**–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!** üöÄ
